<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MongoDB入门 | MJ</title><meta name="author" content="MJ"><meta name="copyright" content="MJ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="这是MongoDB数据库的入门笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="MongoDB入门">
<meta property="og:url" content="http://mjhub1.github.io/posts/661780e7.html">
<meta property="og:site_name" content="MJ">
<meta property="og:description" content="这是MongoDB数据库的入门笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/05/16/W9gwSCKTyndMRO4.jpg">
<meta property="article:published_time" content="2023-05-27T05:17:00.222Z">
<meta property="article:modified_time" content="2023-05-27T14:13:08.974Z">
<meta property="article:author" content="MJ">
<meta property="article:tag" content="MongoDB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/05/16/W9gwSCKTyndMRO4.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2023/05/28/EoxnY7LIHv3yN4w.png"><link rel="canonical" href="http://mjhub1.github.io/posts/661780e7.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":100,"languages":{"author":"作者: MJ","link":"链接: ","source":"来源: MJ","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MongoDB入门',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-27 22:13:08'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/waves.css"><link rel="stylesheet" href="/css/mybackgroud.css"><link rel="stylesheet" href="/css/catalogbar.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = 'hidden';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}

preloader.initLoading()
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2023/05/14/gWK7DakqILfvCby.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-clock"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E7%AC%94%E8%AE%B0/"><i class="fa-fw fas fa-n"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E8%B5%84%E6%BA%90/"><i class="fa-fw fas fa-s"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E9%A1%B9%E7%9B%AE/"><i class="fa-fw fas fa-p"></i><span> 项目</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url('https://s2.loli.net/2023/05/16/W9gwSCKTyndMRO4.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="MJ"><span class="site-name">MJ</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-clock"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E7%AC%94%E8%AE%B0/"><i class="fa-fw fas fa-n"></i><span> 笔记</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E8%B5%84%E6%BA%90/"><i class="fa-fw fas fa-s"></i><span> 资源</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E9%A1%B9%E7%9B%AE/"><i class="fa-fw fas fa-p"></i><span> 项目</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MongoDB入门</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-05-27T05:17:00.222Z" title="发表于 2023-05-27 13:17:00">2023-05-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-27T14:13:08.974Z" title="更新于 2023-05-27 22:13:08">2023-05-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="分布式系统"><a href="#分布式系统" class="headerlink" title="分布式系统"></a>分布式系统</h3><h4 id="1-分布式计算的优点："><a href="#1-分布式计算的优点：" class="headerlink" title="1.分布式计算的优点："></a>1.分布式计算的优点：</h4><p>可靠性（容错） ：<br>分布式计算系统中的一个重要的优点是可靠性。一台服务器的系统崩溃并不影响到其余的服务器。<br>可扩展性：<br>在分布式计算系统可以根据需要增加更多的机器。<br>资源共享：<br>共享数据是必不可少的应用，如银行，预订系统。<br>灵活性：<br>由于该系统是非常灵活的，它很容易安装，实施和调试新的服务。<br>更快的速度：<br>分布式计算系统可以有多台计算机的计算能力，使得它比其他系统有更快的处理速度。<br>开放系统：<br>由于它是开放的系统，本地或者远程都可以访问到该服务。<br>更高的性能：<br>相较于集中式计算机网络集群可以提供更高的性能（及更好的性价比）。</p>
<h4 id="2-分布式计算的缺点："><a href="#2-分布式计算的缺点：" class="headerlink" title="2.分布式计算的缺点："></a>2.分布式计算的缺点：</h4><p>故障排除：<br>故障排除和诊断问题。<br>软件：<br>更少的软件支持是分布式计算系统的主要缺点。<br>网络：<br>网络基础设施的问题，包括：传输问题，高负载，信息丢失等。<br>安全性：<br>开放系统的特性让分布式计算系统存在着数据的安全性和共享的风险等问题。</p>
<h3 id="NoSQL简介"><a href="#NoSQL简介" class="headerlink" title="NoSQL简介"></a>NoSQL简介</h3><h4 id="1-定义："><a href="#1-定义：" class="headerlink" title="1.定义："></a>1.定义：</h4><p>NoSQL(NoSQL &#x3D; Not Only SQL )，意即”不仅仅是SQL”。</p>
<h4 id="2-什么是NoSQL"><a href="#2-什么是NoSQL" class="headerlink" title="2.什么是NoSQL?"></a>2.什么是NoSQL?</h4><p>NoSQL，指的是非关系型的数据库。NoSQL有时也称作Not Only SQL的缩写，是对不同于传统的关系型数据库的数据库管理系统的统称。<br>NoSQL用于超大规模数据的存储。（例如谷歌或Facebook每天为他们的用户收集万亿比特的数据）。这些类型的数据存储不需要固定的模式，无需多余操作就可以横向扩展。</p>
<h4 id="3-为什么使用NoSQL"><a href="#3-为什么使用NoSQL" class="headerlink" title="3.为什么使用NoSQL ?"></a>3.为什么使用NoSQL ?</h4><p>今天我们可以通过第三方平台（如：Google,Facebook等）可以很容易的访问和抓取数据。用户的个人信息，社交网络，地理位置，用户生成的数据和用户操作日志已经成倍的增加。我们如果要对这些用户数据进行挖掘，那SQL数据库已经不适合这些应用了, NoSQL 数据库的发展却能很好的处理这些大的数据。</p>
<h4 id="4-RDBMS-vs-NoSQL"><a href="#4-RDBMS-vs-NoSQL" class="headerlink" title="4.RDBMS vs NoSQL"></a>4.RDBMS vs NoSQL</h4><p>RDBMS<br>-高度组织化结构化数据<br>-结构化查询语言（SQL） (SQL)<br>-数据和关系都存储在单独的表中。<br>-数据操纵语言，数据定义语言<br>-严格的一致性<br>-基础事务<br>NoSQL<br>-代表着不仅仅是SQL<br>-没有声明性查询语言<br>-没有预定义的模式<br>-键-值对存储，列存储，文档存储，图形数据库<br>-最终一致性，而非ACID属性<br>-非结构化和不可预知的数据<br>-CAP定理<br>-高性能，高可用性和可伸缩性</p>
<h4 id="5-NoSQL的优点-x2F-缺点"><a href="#5-NoSQL的优点-x2F-缺点" class="headerlink" title="5.NoSQL的优点&#x2F;缺点"></a>5.NoSQL的优点&#x2F;缺点</h4><p>优点:<br>-高可扩展性<br>-分布式计算<br>-低成本<br>-架构的灵活性，半结构化数据<br>-没有复杂的关系<br>缺点:<br>-没有标准化<br>-有限的查询功能（到目前为止）<br>-最终一致是不直观的程序</p>
<h4 id="6-BASE"><a href="#6-BASE" class="headerlink" title="6.BASE"></a>6.BASE</h4><p>BASE：Basically Available, Soft-state, Eventually Consistent。 由 Eric Brewer 定义。<br>CAP理论的核心是：一个分布式系统不可能同时很好的满足一致性，可用性和分区容错性这三个需求，最多只能同时较好的满足两个。<br>BASE是NoSQL数据库通常对可用性及一致性的弱要求原则:<br>Basically Available –基本可用<br>Soft-state –软状态&#x2F;柔性事务。 “Soft state” 可以理解为”无连接”的, 而 “Hard state” 是”面向连接”的<br>Eventually Consistency – 最终一致性， 也是 ACID 的最终目的。</p>
<h3 id="MongoDB简介"><a href="#MongoDB简介" class="headerlink" title="MongoDB简介"></a>MongoDB简介</h3><h4 id="1-概念："><a href="#1-概念：" class="headerlink" title="1.概念："></a>1.概念：</h4><p>MongoDB 是由C++语言编写的，是一个基于分布式文件存储的开源数据库系统。<br>在高负载的情况下，添加更多的节点，可以保证服务器性能。<br>MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。<br>MongoDB 将数据存储为一个文档，数据结构由键值(key&#x3D;&gt;value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p>
<h4 id="2-主要特点"><a href="#2-主要特点" class="headerlink" title="2.主要特点"></a>2.主要特点</h4><p>MongoDB 是一个面向文档存储的数据库，操作起来比较简单和容易。<br>你可以在MongoDB记录中设置任何属性的索引 (如：FirstName&#x3D;”Sameer”,Address&#x3D;”8 Gandhi Road”)来实现更快的排序。<br>你可以通过本地或者网络创建数据镜像，这使得MongoDB有更强的扩展性。<br>如果负载的增加（需要更多的存储空间和更强的处理能力） ，它可以分布在计算机网络中的其他节点上这就是所谓的分片。<br>Mongo支持丰富的查询表达式。查询指令使用JSON形式的标记，可轻易查询文档中内嵌的对象及数组。<br>MongoDb 使用update()命令可以实现替换完成的文档（数据）或者一些指定的数据字段 。<br>Mongodb中的Map&#x2F;reduce主要是用来对数据进行批量处理和聚合操作。<br>Map和Reduce。Map函数调用emit(key,value)遍历集合中所有的记录，将key与value传给Reduce函数进行处理。<br>Map函数和Reduce函数是使用Javascript编写的，并可以通过db.runCommand或mapreduce命令来执行MapReduce操作。<br>GridFS是MongoDB中的一个内置功能，可以用于存放大量小文件。<br>MongoDB允许在服务端执行脚本，可以用Javascript编写某个函数，直接在服务端执行，也可以把函数的定义存储在服务端，下次直接调用即可。<br>MongoDB支持各种编程语言:RUBY，PYTHON，JAVA，C++，PHP，C#等多种语言。<br>MongoDB安装简单。</p>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><p>显示所有数据的列表：show dbs<br>显示当前数据库对象或集合：db<br>连接到一个指定的数据库：use 库名 </p>
<h3 id="常见概念"><a href="#常见概念" class="headerlink" title="常见概念"></a>常见概念</h3><h4 id="1-数据库命名规则"><a href="#1-数据库命名规则" class="headerlink" title="1.数据库命名规则"></a>1.数据库命名规则</h4><p>不能是空字符串（””)。<br>不得含有’ ‘（空格)、.、$、&#x2F;、\和\0 (空字符)。<br>应全部小写。<br>最多64字节。</p>
<h4 id="2-RDBMS-与-MongoDB-对应的术语"><a href="#2-RDBMS-与-MongoDB-对应的术语" class="headerlink" title="2.RDBMS 与 MongoDB 对应的术语"></a>2.RDBMS 与 MongoDB 对应的术语</h4><p>数据库	数据库<br>表格	集合<br>行	文档<br>列	字段<br>表联合	嵌入文档<br>主键	主键 (MongoDB 提供了 key 为 _id )</p>
<h4 id="3-文档键命名规则"><a href="#3-文档键命名规则" class="headerlink" title="3.文档键命名规则"></a>3.文档键命名规则</h4><p>键不能含有\0 (空字符)。这个字符用来表示键的结尾。<br>.和$有特别的意义，只有在特定环境下才能使用。<br>以下划线”_”开头的键是保留的(不是严格要求的)。<br>注：<br>文档中的键&#x2F;值对是有序的。<br>文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档)。<br>MongoDB区分类型和大小写。<br>MongoDB的文档不能有重复的键。<br>文档的键是字符串。除了少数例外情况，键可以使用任意UTF-8字符。</p>
<h4 id="4-集合命名规则"><a href="#4-集合命名规则" class="headerlink" title="4.集合命名规则"></a>4.集合命名规则</h4><p>集合名不能是空字符串””。<br>集合名不能含有\0字符（空字符)，这个字符表示集合名的结尾。<br>集合名不能以”system.”开头，这是为系统集合保留的前缀。<br>用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集合名里面包含，这是因为某些系统生成的集合中包含该字符。除非你要访问这种系统创建的集合，否则千万不要在名字里出现$。　</p>
<h4 id="5-MongoDB-数据类型"><a href="#5-MongoDB-数据类型" class="headerlink" title="5.MongoDB 数据类型"></a>5.MongoDB 数据类型</h4><p>String	字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。<br>Integer	整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。<br>Boolean	布尔值。用于存储布尔值（真&#x2F;假）。<br>Double	双精度浮点值。用于存储浮点值。<br>Min&#x2F;Max keys	将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。<br>Array	用于将数组或列表或多个值存储为一个键。<br>Timestamp	时间戳。记录文档修改或添加的具体时间。<br>Object	用于内嵌文档。<br>Null	用于创建空值。<br>Symbol	符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。<br>Date	日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。<br>Object ID	对象 ID。用于创建文档的 ID。<br>Binary Data	二进制数据。用于存储二进制数据。<br>Code	代码类型。用于在文档中存储 JavaScript 代码。<br>Regular expression	正则表达式类型。用于存储正则表达式。</p>
<h4 id="6-元数据"><a href="#6-元数据" class="headerlink" title="6.元数据"></a>6.元数据</h4><p>数据库的信息是存储在集合中，它们使用了系统的命名空间：dbname.system.*</p>
<h3 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h3><blockquote>
<p>创建数据库：use DATABASE_NAME</p>
<blockquote>
<p>注：在 MongoDB 中，集合只有在内容插入后才会创建! 就是说，创建集合(数据表)后要再插入一个文档(记录)，集合才会真正创建。</p>
</blockquote>
</blockquote>
<blockquote>
<p>查看所有数据库：show dbs<br>删除数据库：db.dropDatabase()</p>
</blockquote>
<h3 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h3><blockquote>
<p>创建集合：db.createCollection(“name”, {options}) </p>
<blockquote>
<p>options: capped	autoIndexId	 size	max	</p>
</blockquote>
</blockquote>
<blockquote>
<p>查看当前集合：show collections 或  show tables<br>删除集合：db.collection.drop()</p>
</blockquote>
<p>注：在 MongoDB 中，你不需要创建集合。当你插入一些文档时，MongoDB 会自动创建集合。</p>
<h3 id="文档操作"><a href="#文档操作" class="headerlink" title="文档操作"></a>文档操作</h3><h4 id="1-插入文档："><a href="#1-插入文档：" class="headerlink" title="1.插入文档："></a>1.插入文档：</h4><blockquote>
<p>方式一：db.COLLECTION_NAME.insert(document)<br>方式二：db.COLLECTION_NAME.save(document)</p>
</blockquote>
<p>save()：如果 _id 主键存在则更新数据，如果不存在就插入数据。该方法新版本中已废弃，可以使用 db.collection.insertOne() 或 db.collection.replaceOne() 来代替。<br>insert(): 若插入的数据主键已经存在，则会抛 org.springframework.dao.DuplicateKeyException 异常，提示主键重复，不保存当前数据。<br>3.2 版本之后：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">方式三：</span><br><span class="line">db.collection.insertOne(</span><br><span class="line">   &lt;document&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">      writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br><span class="line">方式四：</span><br><span class="line">db.collection.insertMany(</span><br><span class="line">   [ &lt;document 1&gt; , &lt;document 2&gt;, ... ],</span><br><span class="line">   &#123;</span><br><span class="line">      writeConcern: &lt;document&gt;,</span><br><span class="line">      ordered: &lt;boolean&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="2-更新文档"><a href="#2-更新文档" class="headerlink" title="2.更新文档"></a>2.更新文档</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">方式一：</span><br><span class="line">db.collection.update(</span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &lt;update&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     upsert: &lt;boolean&gt;,</span><br><span class="line">     multi: &lt;boolean&gt;,</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>参数说明：<br>query : update的查询条件，类似sql update查询内where后面的。<br>update : update的对象和一些更新的操作符（如$,$inc…）等，也可以理解为sql update查询内set后面的<br>upsert : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。<br>multi : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。<br>writeConcern :可选，抛出异常的级别。</p>
<blockquote>
<p>方式二：使用save()方法，并指定要替换的文档主键_id</p>
</blockquote>
<h4 id="3-删除文档"><a href="#3-删除文档" class="headerlink" title="3.删除文档"></a>3.删除文档</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">方式一：</span><br><span class="line">db.collection.remove(</span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &lt;justOne&gt;</span><br><span class="line">)</span><br><span class="line">MongoDB 是 2.6 版本以后：</span><br><span class="line">db.collection.remove(</span><br><span class="line">   &lt;query&gt;,</span><br><span class="line">   &#123;</span><br><span class="line">     justOne: &lt;boolean&gt;,</span><br><span class="line">     writeConcern: &lt;document&gt;</span><br><span class="line">   &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>参数说明：<br>query :（可选）删除的文档的条件。<br>justOne : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除所有匹配条件的文档。<br>writeConcern :（可选）抛出异常的级别。</p>
<p>删除所有数据: db.collection.remove({}) （类似常规 SQL 的 truncate 命令）</p>
<h4 id="4-查看文档"><a href="#4-查看文档" class="headerlink" title="4.查看文档"></a>4.查看文档</h4><p>查询文档: db.collection.find(query, projection)<br>查询一个文档：db.collection.findOne()<br>以格式化的方式来显示所有文档: db.collection.find().pretty()</p>
<h3 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h3><h4 id="1-MongoDB-与-RDBMS-Where-语句比较"><a href="#1-MongoDB-与-RDBMS-Where-语句比较" class="headerlink" title="1.MongoDB 与 RDBMS Where 语句比较"></a>1.MongoDB 与 RDBMS Where 语句比较</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">等于	&#123;&lt;key&gt;:&lt;value&gt;&#125;	db.col.find(&#123;&quot;by&quot;:&quot;菜鸟教程&quot;&#125;).pretty()	where by = &#x27;菜鸟教程&#x27;</span><br><span class="line">小于	&#123;&lt;key&gt;:&#123;$lt:&lt;value&gt;&#125;&#125;	db.col.find(&#123;&quot;likes&quot;:&#123;$lt:50&#125;&#125;).pretty()	where likes &lt; 50</span><br><span class="line">小于或等于	&#123;&lt;key&gt;:&#123;$lte:&lt;value&gt;&#125;&#125;	db.col.find(&#123;&quot;likes&quot;:&#123;$lte:50&#125;&#125;).pretty()	where likes &lt;= 50</span><br><span class="line">大于	&#123;&lt;key&gt;:&#123;$gt:&lt;value&gt;&#125;&#125;	db.col.find(&#123;&quot;likes&quot;:&#123;$gt:50&#125;&#125;).pretty()	where likes &gt; 50</span><br><span class="line">大于或等于	&#123;&lt;key&gt;:&#123;$gte:&lt;value&gt;&#125;&#125;	db.col.find(&#123;&quot;likes&quot;:&#123;$gte:50&#125;&#125;).pretty()	where likes &gt;= 50</span><br><span class="line">不等于	&#123;&lt;key&gt;:&#123;$ne:&lt;value&gt;&#125;&#125;	db.col.find(&#123;&quot;likes&quot;:&#123;$ne:50&#125;&#125;).pretty()	where likes != 50</span><br></pre></td></tr></table></figure>
<h4 id="2-MongoDB-AND-条件"><a href="#2-MongoDB-AND-条件" class="headerlink" title="2.MongoDB AND 条件"></a>2.MongoDB AND 条件</h4><p>MongoDB 的 find() 方法可以传入多个键(key)，每个键(key)以逗号隔开，即常规 SQL 的 AND 条件</p>
<blockquote>
<p>db.col.find({key1:value1, key2:value2}).pretty()</p>
</blockquote>
<h4 id="3-MongoDB-OR-条件"><a href="#3-MongoDB-OR-条件" class="headerlink" title="3.MongoDB OR 条件"></a>3.MongoDB OR 条件</h4><p>MongoDB OR 条件语句使用了关键字 $or</p>
<blockquote>
<p>db.col.find({$or: [{key1: value1}, {key2:value2}]}).pretty()</p>
</blockquote>
<h3 id="type-操作符"><a href="#type-操作符" class="headerlink" title="$type 操作符"></a>$type 操作符</h3><blockquote>
<p>Double	1	<br>String	2	<br>Object	3	<br>Array	4	<br>Binary data	5	<br>Undefined	6	已废弃。<br>Object id	7	<br>Boolean	8	<br>Date	9	<br>Null	10	<br>Regular Expression	11	<br>JavaScript	13	<br>Symbol	14	<br>JavaScript (with scope)	15	<br>32-bit integer	16	<br>Timestamp	17	<br>64-bit integer	18	<br>Min key	255	Query with -1.<br>Max key	127</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">想获取 &quot;col&quot; 集合中 title 为 String 的数据:</span><br><span class="line">db.col.find(&#123;&quot;title&quot; : &#123;$type : 2&#125;&#125;)</span><br><span class="line">或</span><br><span class="line">db.col.find(&#123;&quot;title&quot; : &#123;$type : &#x27;string&#x27;&#125;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Limit与Skip方法"><a href="#Limit与Skip方法" class="headerlink" title="Limit与Skip方法"></a>Limit与Skip方法</h3><h4 id="1-Limit-：读取指定数量的数据记录"><a href="#1-Limit-：读取指定数量的数据记录" class="headerlink" title="1.Limit()：读取指定数量的数据记录"></a>1.Limit()：读取指定数量的数据记录</h4><blockquote>
<p>db.COLLECTION_NAME.find().limit(NUMBER)</p>
</blockquote>
<h4 id="2-Skip-方法：跳过指定数量的数据"><a href="#2-Skip-方法：跳过指定数量的数据" class="headerlink" title="2.Skip() 方法：跳过指定数量的数据"></a>2.Skip() 方法：跳过指定数量的数据</h4><blockquote>
<p>db.COLLECTION_NAME.find().limit(NUMBER).skip(NUMBER)</p>
</blockquote>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>使用 sort() 方法对数据进行排序，sort() 方法可以通过参数指定排序的字段，并使用 1 和 -1 来指定排序的方式，其中 1 为升序排列，而 -1 是用于降序排列。</p>
<blockquote>
<p>db.COLLECTION_NAME.find().sort({KEY:1})</p>
</blockquote>
<h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><blockquote>
<p>创建索引：db.collection.createIndex(keys, options)<br>查看集合索引：db.col.getIndexes()<br>查看集合索引大小：db.col.totalIndexSize()<br>删除集合所有索引：db.col.dropIndexes()<br>删除集合指定索引：db.col.dropIndex(“索引名称”)</p>
</blockquote>
<p>Key 值为你要创建的索引字段，1 为指定按升序创建索引，如果你想按降序来创建索引指定为 -1<br>注：<br>在 3.0.0 版本前创建索引方法为 db.collection.ensureIndex()，之后的版本使用了 db.collection.createIndex() 方法，ensureIndex() 还能用，但只是 createIndex() 的别名。</p>
<p>参数说明：<br>background	Boolean	建索引过程会阻塞其它数据库操作，background可指定以后台方式创建索引，即增加 “background” 可选参数。 “background” 默认值为false。<br>unique	Boolean	建立的索引是否唯一。指定为true创建唯一索引。默认值为false.<br>name	string	索引的名称。如果未指定，MongoDB的通过连接索引的字段名和排序顺序生成一个索引名称。<br>dropDups	Boolean	3.0+版本已废弃。在建立唯一索引时是否删除重复记录,指定 true 创建唯一索引。默认值为 false.<br>sparse	Boolean	对文档中不存在的字段数据不启用索引；这个参数需要特别注意，如果设置为true的话，在索引字段中不会查询出不包含对应字段的文档.。默认值为 false.<br>expireAfterSeconds	integer	指定一个以秒为单位的数值，完成 TTL设定，设定集合的生存时间。<br>v	index version	索引的版本号。默认的索引版本取决于mongod创建索引时运行的版本。<br>weights	document	索引权重值，数值在 1 到 99,999 之间，表示该索引相对于其他索引字段的得分权重。<br>default_language	string	对于文本索引，该参数决定了停用词及词干和词器的规则的列表。 默认为英语<br>language_override	string	对于文本索引，该参数指定了包含在文档中的字段名，语言覆盖默认的language，默认值为 language.</p>
<h3 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h3><p>MongoDB中聚合的方法使用aggregate()，类似 SQL 语句中的 count(*)</p>
<blockquote>
<p>db.COLLECTION_NAME.aggregate(AGGREGATE_OPERATION)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sum	计算总和。	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, num_tutorial : &#123;$sum : &quot;$likes&quot;&#125;&#125;&#125;])</span><br><span class="line">$avg	计算平均值	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, num_tutorial : &#123;$avg : &quot;$likes&quot;&#125;&#125;&#125;])</span><br><span class="line">$min	获取集合中所有文档对应值得最小值。	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, num_tutorial : &#123;$min : &quot;$likes&quot;&#125;&#125;&#125;])</span><br><span class="line">$max	获取集合中所有文档对应值得最大值。	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, num_tutorial : &#123;$max : &quot;$likes&quot;&#125;&#125;&#125;])</span><br><span class="line">$push	将值加入一个数组中，不会判断是否有重复的值。	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, url : &#123;$push: &quot;$url&quot;&#125;&#125;&#125;])</span><br><span class="line">$addToSet	将值加入一个数组中，会判断是否有重复的值，若相同的值在数组中已经存在了，则不加入。	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, url : &#123;$addToSet : &quot;$url&quot;&#125;&#125;&#125;])</span><br><span class="line">$first	根据资源文档的排序获取第一个文档数据。	db.mycol.aggregate([&#123;$group : &#123;_id : &quot;$by_user&quot;, first_url : &#123;$first : &quot;$url&quot;&#125;&#125;&#125;])</span><br><span class="line">$last	根据资源文档的排序获取最后一个文档数据</span><br></pre></td></tr></table></figure>

<h3 id="复制-副本集"><a href="#复制-副本集" class="headerlink" title="复制(副本集)"></a>复制(副本集)</h3><h4 id="1-复制原理："><a href="#1-复制原理：" class="headerlink" title="1.复制原理："></a>1.复制原理：</h4><p>mongodb的复制至少需要两个节点。其中一个是主节点，负责处理客户端请求，其余的都是从节点，负责复制主节点上的数据。<br>mongodb各个节点常见的搭配方式为：一主一从、一主多从。<br>主节点记录在其上的所有操作oplog，从节点定期轮询主节点获取这些操作，然后对自己的数据副本执行这些操作，从而保证从节点的数据与主节点一致。</p>
<h4 id="2-副本集设置"><a href="#2-副本集设置" class="headerlink" title="2.副本集设置"></a>2.副本集设置</h4><p>关闭正在运行的MongoDB服务器：mongod –port “PORT” –dbpath “YOUR_DB_DATA_PATH” –replSet “REPLICA_SET_INSTANCE_NAME”</p>
<blockquote>
<p>启动一个新的副本集：rs.initiate()<br>查看副本集的配置：rs.conf()<br>查看副本集状态： rs.status()<br>添加成员：rs.add(HOST_NAME:PORT)<br>判断当前运行的Mongo服务是否为主节点：db.isMaster() </p>
</blockquote>
<p>注：MongoDB的副本集与我们常见的主从有所不同，主从在主机宕机后所有服务将停止，而副本集在主机宕机后，副本会接管主节点成为主节点，不会出现宕机的情况。</p>
<h3 id="分片"><a href="#分片" class="headerlink" title="分片"></a>分片</h3><h4 id="1-为什么使用分片？"><a href="#1-为什么使用分片？" class="headerlink" title="1.为什么使用分片？"></a>1.为什么使用分片？</h4><p>复制所有的写入操作到主节点<br>延迟的敏感数据会在主节点查询<br>单个副本集限制在12个节点<br>当请求量巨大时会出现内存不足。<br>本地磁盘不足<br>垂直扩展价格昂贵</p>
<h4 id="2-分片的主要组件"><a href="#2-分片的主要组件" class="headerlink" title="2.分片的主要组件"></a>2.分片的主要组件</h4><p>Shard:<br>用于存储实际的数据块，实际生产环境中一个shard server角色可由几台机器组个一个replica set承担，防止主机单点故障<br>Config Server:<br>mongod实例，存储了整个 ClusterMetadata，其中包括 chunk信息。<br>Query Routers:<br>前端路由，客户端由此接入，且让整个集群看上去像单一数据库，前端应用可以透明使用。</p>
<h3 id="备份-mongodump-与恢复-mongorestore"><a href="#备份-mongodump-与恢复-mongorestore" class="headerlink" title="备份(mongodump)与恢复(mongorestore)"></a>备份(mongodump)与恢复(mongorestore)</h3><h4 id="1-数据备份"><a href="#1-数据备份" class="headerlink" title="1.数据备份"></a>1.数据备份</h4><p>使用mongodump命令来备份MongoDB数据。该命令可以导出所有数据到指定目录中。<br>mongodump命令可以通过参数指定导出的数据量级转存的服务器。</p>
<blockquote>
<p>mongodump -h dbhost -d dbname -o dbdirectory</p>
</blockquote>
<p>参数说明：<br>-h：<br>MongoDB 所在服务器地址，例如：127.0.0.1，当然也可以指定端口号：127.0.0.1:27017<br>-d：<br>需要备份的数据库实例，例如：test<br>-o：<br>备份的数据存放位置，例如：c:\data\dump，当然该目录需要提前建立，在备份完成后，系统自动在dump目录下建立一个test目录，这个目录里面存放该数据库实例的备份数据。</p>
<h4 id="2-数据恢复"><a href="#2-数据恢复" class="headerlink" title="2.数据恢复"></a>2.数据恢复</h4><p>使用 mongorestore 命令来恢复备份的数据。</p>
<blockquote>
<p>mongorestore -h &lt;hostname&gt;&lt;:port&gt; -d dbname &lt;path&gt;</p>
</blockquote>
<p>参数说明：<br>-host &lt;:port&gt;, -h &lt;:port&gt;：<br>MongoDB所在服务器地址，默认为： localhost:27017<br>–db , -d ：<br>需要恢复的数据库实例，例如：test，当然这个名称也可以和备份时候的不一样，比如test2<br>–drop：<br>恢复的时候，先删除当前数据，然后恢复备份的数据。就是说，恢复后，备份后添加修改的数据都会被删除，慎用哦！<br>&lt;path&gt;：<br>mongorestore 最后的一个参数，设置备份数据所在位置，例如：c:\data\dump\test。<br>你不能同时指定 &lt;path&gt; 和 –dir 选项，–dir也可以设置备份目录。<br>–dir：<br>指定备份的目录<br>你不能同时指定 &lt;path&gt; 和 –dir 选项。</p>
<h3 id="监控"><a href="#监控" class="headerlink" title="监控"></a>监控</h3><p>MongoDB中提供了mongostat 和 mongotop 两个命令来监控MongoDB的运行情况。</p>
<p>mongostat是mongodb自带的状态检测工具，在命令行下使用。它会间隔固定时间获取mongodb的当前运行状态，并输出。如果你发现数据库突然变慢或者有其他问题的话，你第一手的操作就考虑采用mongostat来查看mongo的状态。<br>启动你的Mongod服务，进入到你安装的MongoDB目录下的bin目录， 然后输入mongostat命令，如下所示：</p>
<blockquote>
<p>$ D:\set up\mongodb\bin&gt;mongostat</p>
</blockquote>
<p>mongotop也是mongodb下的一个内置工具，mongotop提供了一个方法，用来跟踪一个MongoDB的实例，查看哪些大量的时间花费在读取和写入数据。 mongotop提供每个集合的水平的统计数据。默认情况下，mongotop返回值的每一秒。<br>启动你的Mongod服务，进入到你安装的MongoDB目录下的bin目录， 然后输入mongotop命令，如下所示：</p>
<blockquote>
<p>$ D:\set up\mongodb\bin&gt;mongotop</p>
</blockquote>
<hr>
<p>😊END</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://MJhub1.github.io">MJ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://mjhub1.github.io/posts/661780e7.html">http://mjhub1.github.io/posts/661780e7.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://MJhub1.github.io" target="_blank">MJ</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MongoDB/">MongoDB</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2023/05/16/W9gwSCKTyndMRO4.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/c24675b4.html" title="MySQL入门"><img class="cover" src="https://s2.loli.net/2023/05/16/7XJVMhTiU4bjys2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL入门</div></div></a></div><div class="next-post pull-right"><a href="/posts/f89c868b.html" title="Hibernate入门"><img class="cover" src="https://s2.loli.net/2023/05/16/W9gwSCKTyndMRO4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hibernate入门</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2023/05/14/gWK7DakqILfvCby.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">MJ</div><div class="author-info__description">do you need my attention?</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/MJhub1" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2078303114@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.</span> <span class="toc-text">分布式系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97%E7%9A%84%E4%BC%98%E7%82%B9%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">1.分布式计算的优点：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97%E7%9A%84%E7%BC%BA%E7%82%B9%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">2.分布式计算的缺点：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NoSQL%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">NoSQL简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">1.定义：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%BB%80%E4%B9%88%E6%98%AFNoSQL"><span class="toc-number">2.2.</span> <span class="toc-text">2.什么是NoSQL?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8NoSQL"><span class="toc-number">2.3.</span> <span class="toc-text">3.为什么使用NoSQL ?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-RDBMS-vs-NoSQL"><span class="toc-number">2.4.</span> <span class="toc-text">4.RDBMS vs NoSQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-NoSQL%E7%9A%84%E4%BC%98%E7%82%B9-x2F-%E7%BC%BA%E7%82%B9"><span class="toc-number">2.5.</span> <span class="toc-text">5.NoSQL的优点&#x2F;缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-BASE"><span class="toc-number">2.6.</span> <span class="toc-text">6.BASE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB%E7%AE%80%E4%BB%8B"><span class="toc-number">3.</span> <span class="toc-text">MongoDB简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A6%82%E5%BF%B5%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">1.概念：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E4%B8%BB%E8%A6%81%E7%89%B9%E7%82%B9"><span class="toc-number">3.2.</span> <span class="toc-text">2.主要特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">4.</span> <span class="toc-text">常用命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%A6%82%E5%BF%B5"><span class="toc-number">5.</span> <span class="toc-text">常见概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">5.1.</span> <span class="toc-text">1.数据库命名规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-RDBMS-%E4%B8%8E-MongoDB-%E5%AF%B9%E5%BA%94%E7%9A%84%E6%9C%AF%E8%AF%AD"><span class="toc-number">5.2.</span> <span class="toc-text">2.RDBMS 与 MongoDB 对应的术语</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%96%87%E6%A1%A3%E9%94%AE%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">5.3.</span> <span class="toc-text">3.文档键命名规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%9B%86%E5%90%88%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="toc-number">5.4.</span> <span class="toc-text">4.集合命名规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-MongoDB-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">5.5.</span> <span class="toc-text">5.MongoDB 数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">5.6.</span> <span class="toc-text">6.元数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">数据库操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-number">7.</span> <span class="toc-text">集合操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3%E6%93%8D%E4%BD%9C"><span class="toc-number">8.</span> <span class="toc-text">文档操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%8F%92%E5%85%A5%E6%96%87%E6%A1%A3%EF%BC%9A"><span class="toc-number">8.1.</span> <span class="toc-text">1.插入文档：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0%E6%96%87%E6%A1%A3"><span class="toc-number">8.2.</span> <span class="toc-text">2.更新文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-number">8.3.</span> <span class="toc-text">3.删除文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E6%9F%A5%E7%9C%8B%E6%96%87%E6%A1%A3"><span class="toc-number">8.4.</span> <span class="toc-text">4.查看文档</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="toc-number">9.</span> <span class="toc-text">条件判断</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-MongoDB-%E4%B8%8E-RDBMS-Where-%E8%AF%AD%E5%8F%A5%E6%AF%94%E8%BE%83"><span class="toc-number">9.1.</span> <span class="toc-text">1.MongoDB 与 RDBMS Where 语句比较</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-MongoDB-AND-%E6%9D%A1%E4%BB%B6"><span class="toc-number">9.2.</span> <span class="toc-text">2.MongoDB AND 条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-MongoDB-OR-%E6%9D%A1%E4%BB%B6"><span class="toc-number">9.3.</span> <span class="toc-text">3.MongoDB OR 条件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#type-%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">10.</span> <span class="toc-text">$type 操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Limit%E4%B8%8ESkip%E6%96%B9%E6%B3%95"><span class="toc-number">11.</span> <span class="toc-text">Limit与Skip方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Limit-%EF%BC%9A%E8%AF%BB%E5%8F%96%E6%8C%87%E5%AE%9A%E6%95%B0%E9%87%8F%E7%9A%84%E6%95%B0%E6%8D%AE%E8%AE%B0%E5%BD%95"><span class="toc-number">11.1.</span> <span class="toc-text">1.Limit()：读取指定数量的数据记录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Skip-%E6%96%B9%E6%B3%95%EF%BC%9A%E8%B7%B3%E8%BF%87%E6%8C%87%E5%AE%9A%E6%95%B0%E9%87%8F%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">11.2.</span> <span class="toc-text">2.Skip() 方法：跳过指定数量的数据</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">12.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">13.</span> <span class="toc-text">索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E5%90%88"><span class="toc-number">14.</span> <span class="toc-text">聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6-%E5%89%AF%E6%9C%AC%E9%9B%86"><span class="toc-number">15.</span> <span class="toc-text">复制(副本集)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%EF%BC%9A"><span class="toc-number">15.1.</span> <span class="toc-text">1.复制原理：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%89%AF%E6%9C%AC%E9%9B%86%E8%AE%BE%E7%BD%AE"><span class="toc-number">15.2.</span> <span class="toc-text">2.副本集设置</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%89%87"><span class="toc-number">16.</span> <span class="toc-text">分片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E5%88%86%E7%89%87%EF%BC%9F"><span class="toc-number">16.1.</span> <span class="toc-text">1.为什么使用分片？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%86%E7%89%87%E7%9A%84%E4%B8%BB%E8%A6%81%E7%BB%84%E4%BB%B6"><span class="toc-number">16.2.</span> <span class="toc-text">2.分片的主要组件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD-mongodump-%E4%B8%8E%E6%81%A2%E5%A4%8D-mongorestore"><span class="toc-number">17.</span> <span class="toc-text">备份(mongodump)与恢复(mongorestore)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD"><span class="toc-number">17.1.</span> <span class="toc-text">1.数据备份</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E6%81%A2%E5%A4%8D"><span class="toc-number">17.2.</span> <span class="toc-text">2.数据恢复</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%91%E6%8E%A7"><span class="toc-number">18.</span> <span class="toc-text">监控</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/b64bf632.html" title="emoji"><img src="https://s2.loli.net/2023/05/16/NfVbmzMWQOus3ke.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="emoji"/></a><div class="content"><a class="title" href="/posts/b64bf632.html" title="emoji">emoji</a><time datetime="2023-05-28T15:19:55.309Z" title="发表于 2023-05-28 23:19:55">2023-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/421a3e14.html" title="Spring入门"><img src="https://s2.loli.net/2023/05/16/KOQ4duUYelw7Bhm.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Spring入门"/></a><div class="content"><a class="title" href="/posts/421a3e14.html" title="Spring入门">Spring入门</a><time datetime="2023-05-28T14:14:26.041Z" title="发表于 2023-05-28 22:14:26">2023-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/64e66de7.html" title="Redis入门"><img src="https://s2.loli.net/2023/05/16/H34wGx2O7oJXzfs.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Redis入门"/></a><div class="content"><a class="title" href="/posts/64e66de7.html" title="Redis入门">Redis入门</a><time datetime="2023-05-28T01:40:15.944Z" title="发表于 2023-05-28 09:40:15">2023-05-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/77699b9e.html" title="数据库调优策略"><img src="https://s2.loli.net/2023/05/16/ZF1XVniTbaOfNH8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库调优策略"/></a><div class="content"><a class="title" href="/posts/77699b9e.html" title="数据库调优策略">数据库调优策略</a><time datetime="2023-05-27T14:18:13.782Z" title="发表于 2023-05-27 22:18:13">2023-05-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/f89c868b.html" title="Hibernate入门"><img src="https://s2.loli.net/2023/05/16/W9gwSCKTyndMRO4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hibernate入门"/></a><div class="content"><a class="title" href="/posts/f89c868b.html" title="Hibernate入门">Hibernate入门</a><time datetime="2023-05-27T09:26:49.935Z" title="发表于 2023-05-27 17:26:49">2023-05-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 By MJ</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"></div><script src="/js/catalog_list_light.js" data-pjax></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>